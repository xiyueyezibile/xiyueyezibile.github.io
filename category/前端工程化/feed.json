{
    "version": "https://jsonfeed.org/version/1",
    "title": "汐月也自闭了的个人博客 • All posts by \"前端工程化\" category",
    "description": "这个需求写不了",
    "home_page_url": "http://example.com",
    "items": [
        {
            "id": "http://example.com/2023/08/20/%E5%89%8D%E7%AB%AF%E5%B7%A5%E7%A8%8B%E5%8C%96/webpack%E4%B8%ADplugin%E4%B8%8Eloader%E5%85%A5%E9%97%A8%E8%AE%B2%E8%A7%A3/",
            "url": "http://example.com/2023/08/20/%E5%89%8D%E7%AB%AF%E5%B7%A5%E7%A8%8B%E5%8C%96/webpack%E4%B8%ADplugin%E4%B8%8Eloader%E5%85%A5%E9%97%A8%E8%AE%B2%E8%A7%A3/",
            "title": "webpack中plugin与loader入门讲解",
            "date_published": "2023-08-19T19:33:25.728Z",
            "content_html": "<h2 id=\"loader-概念\"><a class=\"markdownIt-Anchor\" href=\"#loader-概念\">#</a> loader 概念</h2>\n<p>帮助 webpack 将不同类型的文件转换为 webpack 可识别的模块</p>\n<h2 id=\"loader-执行顺序\"><a class=\"markdownIt-Anchor\" href=\"#loader-执行顺序\">#</a> loader 执行顺序</h2>\n<p>分类:</p>\n<ul>\n<li>pre: 前置 loader</li>\n<li>normal: 普通 loader</li>\n<li>inline: 内联 loader</li>\n<li>post: 后置 loader</li>\n</ul>\n<p>pre &gt; normal &gt; inline &gt; post</p>\n<p>相同优先级 loader 执行顺序为从右到左，从上到下</p>\n<p>如果想要更改执行顺序，可以通过配置 loader 的执行顺序</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">rules</span>: [</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    <span class=\"comment\">// 没有 enforce 就是normal loader</span></span><br><span class=\"line\">    <span class=\"attr\">enforce</span>: <span class=\"string\">&quot;pre&quot;</span> | <span class=\"string\">&quot;post&quot;</span>,</span><br><span class=\"line\">    <span class=\"comment\">// ...</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">]</span><br></pre></td></tr></table></figure>\n<h2 id=\"开发loader\"><a class=\"markdownIt-Anchor\" href=\"#开发loader\">#</a> 开发 loader</h2>\n<h3 id=\"第一个-loader\"><a class=\"markdownIt-Anchor\" href=\"#第一个-loader\">#</a> 第一个 loader</h3>\n<p>创建 <code>loaders/test-loader.js</code></p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// loaders/test-loader.js</span></span><br><span class=\"line\"><span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">  loader 就是一个函数</span></span><br><span class=\"line\"><span class=\"comment\">  当 webpack 解析资源时，会调用相关的loader去处理</span></span><br><span class=\"line\"><span class=\"comment\">  loader 接受文件内容为参数，返回内容出去</span></span><br><span class=\"line\"><span class=\"comment\">  loader 函数的返回值，会作为下一个 loader 的参数</span></span><br><span class=\"line\"><span class=\"comment\">  map -&gt; SourceMap</span></span><br><span class=\"line\"><span class=\"comment\">  meta 别的 loader 传递过来的数据</span></span><br><span class=\"line\"><span class=\"comment\">*/</span></span><br><span class=\"line\"><span class=\"variable language_\">module</span>.<span class=\"property\">exports</span> = <span class=\"keyword\">function</span> (<span class=\"params\">content,map,meta</span>) &#123;</span><br><span class=\"line\">  <span class=\"comment\">// content 为处理的文件内容</span></span><br><span class=\"line\">  <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(content)</span><br><span class=\"line\">  <span class=\"keyword\">return</span> content</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>webpack.config.js 中配置</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// webpack.config.js</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> path = <span class=\"built_in\">require</span>(<span class=\"string\">&quot;path&quot;</span>)</span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"title class_\">HtmlWebpackPlugin</span> = <span class=\"built_in\">require</span>(<span class=\"string\">&quot;html-webpack-plugin&quot;</span>)</span><br><span class=\"line\"><span class=\"variable language_\">module</span>.<span class=\"property\">exports</span> = &#123;</span><br><span class=\"line\">  <span class=\"attr\">entry</span>: <span class=\"string\">&quot;./src/main.js&quot;</span>,</span><br><span class=\"line\">  <span class=\"attr\">output</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">path</span>: path.<span class=\"title function_\">resolve</span>(__dirname, <span class=\"string\">&quot;./dist&quot;</span>),</span><br><span class=\"line\">    <span class=\"attr\">filename</span>: <span class=\"string\">&quot;js/[name].js&quot;</span>,</span><br><span class=\"line\">    <span class=\"attr\">clean</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  <span class=\"attr\">module</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">rules</span>: [</span><br><span class=\"line\">      &#123;</span><br><span class=\"line\">        <span class=\"attr\">test</span>: <span class=\"regexp\">/\\.js$/</span>,</span><br><span class=\"line\">        <span class=\"attr\">loader</span>: <span class=\"string\">&quot;./loaders/test-loader.js&quot;</span>,</span><br><span class=\"line\">      &#125;,</span><br><span class=\"line\">    ],</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  <span class=\"attr\">plugins</span>: [</span><br><span class=\"line\">    <span class=\"keyword\">new</span> <span class=\"title class_\">HtmlWebpackPlugin</span>(&#123;</span><br><span class=\"line\">      <span class=\"attr\">template</span>: path.<span class=\"title function_\">resolve</span>(__dirname, <span class=\"string\">&quot;public/index.html&quot;</span>),</span><br><span class=\"line\">    &#125;),</span><br><span class=\"line\">  ],</span><br><span class=\"line\">  <span class=\"attr\">mode</span>: <span class=\"string\">&quot;development&quot;</span>,</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"loader-定义方式\"><a class=\"markdownIt-Anchor\" href=\"#loader-定义方式\">#</a> loader 定义方式</h3>\n<h4 id=\"同步-loader\"><a class=\"markdownIt-Anchor\" href=\"#同步-loader\">#</a> 同步 loader</h4>\n<p>新建  <code>loaders/demo/test1.js</code></p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 同步loader</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// module.exports = function (contnet) &#123;</span></span><br><span class=\"line\"><span class=\"comment\">//   return content</span></span><br><span class=\"line\"><span class=\"comment\">// &#125;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"variable language_\">module</span>.<span class=\"property\">exports</span> = <span class=\"keyword\">function</span> (<span class=\"params\">content, map, meta</span>) &#123;</span><br><span class=\"line\">  <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">   * 第一个参数, err 代表是否有错误</span></span><br><span class=\"line\"><span class=\"comment\">   * 第二个参数, content 处理后的内容</span></span><br><span class=\"line\"><span class=\"comment\">   * 第三个参数, source-map 继续传递source-map</span></span><br><span class=\"line\"><span class=\"comment\">   * 第四个参数, meta 给下一个 loader 传递参数</span></span><br><span class=\"line\"><span class=\"comment\">   */</span></span><br><span class=\"line\">  <span class=\"variable language_\">this</span>.<span class=\"title function_\">callback</span>(<span class=\"literal\">null</span>, content, map, meta)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h4 id=\"异步-loader\"><a class=\"markdownIt-Anchor\" href=\"#异步-loader\">#</a> 异步 loader</h4>\n<p>新建  <code>loaders/demo/test2.js</code></p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"variable language_\">module</span>.<span class=\"property\">exports</span> = <span class=\"keyword\">function</span> (<span class=\"params\">content, map, meta</span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> callback = <span class=\"variable language_\">this</span>.<span class=\"title function_\">async</span>()</span><br><span class=\"line\">  <span class=\"built_in\">setTimeout</span>(<span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"title function_\">callback</span>(<span class=\"literal\">null</span>, content, map, meta)</span><br><span class=\"line\">  &#125;, <span class=\"number\">1000</span>)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>异步 loader 需要调用  <code>this.async()</code>  方法，返回一个 callback 函数。<br>\n它会等异步操作做完再执行后面的 loader</p>\n<h3 id=\"raw-loader\"><a class=\"markdownIt-Anchor\" href=\"#raw-loader\">#</a> raw loader</h3>\n<p>新建  <code>loaders/demo/test3.js</code></p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// raw loader 接受的 content 是 Buffer 数据</span></span><br><span class=\"line\"><span class=\"variable language_\">module</span>.<span class=\"property\">exports</span> = <span class=\"keyword\">function</span> (<span class=\"params\">content</span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> content</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"variable language_\">module</span>.<span class=\"property\">exports</span>.<span class=\"property\">raw</span> = <span class=\"literal\">true</span></span><br></pre></td></tr></table></figure>\n<p>raw loader 既可以是同步 loader 也可以是异步 loader</p>\n<h3 id=\"pitch-loader\"><a class=\"markdownIt-Anchor\" href=\"#pitch-loader\">#</a> pitch loader</h3>\n<p>新建  <code>loaders/demo/test4.js</code></p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"variable language_\">module</span>.<span class=\"property\">exports</span> = <span class=\"keyword\">function</span> (<span class=\"params\">content</span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> content</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"variable language_\">module</span>.<span class=\"property\">exports</span>.<span class=\"property\">pitch</span> = <span class=\"keyword\">function</span> (<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">  <span class=\"comment\">// 这个函数会提前执行</span></span><br><span class=\"line\">  <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&quot;pitch&quot;</span>)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 执行顺序</span></span><br><span class=\"line\"><span class=\"comment\"> * use [1,2,3]</span></span><br><span class=\"line\"><span class=\"comment\"> * pitchfunc [p1,p2,p3]</span></span><br><span class=\"line\"><span class=\"comment\"> * 顺序</span></span><br><span class=\"line\"><span class=\"comment\"> * p1,p2,p3,3,2,1</span></span><br><span class=\"line\"><span class=\"comment\"> * 如果在 p1 中 return</span></span><br><span class=\"line\"><span class=\"comment\"> * 顺序</span></span><br><span class=\"line\"><span class=\"comment\"> * p1,p2,1</span></span><br><span class=\"line\"><span class=\"comment\"> * 如果没有1,顺序</span></span><br><span class=\"line\"><span class=\"comment\"> * p1,p2</span></span><br><span class=\"line\"><span class=\"comment\"> * 这种机制被称为熔断</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"loader-api\"><a class=\"markdownIt-Anchor\" href=\"#loader-api\">#</a> loader API</h2>\n<ul>\n<li>this.async () 异步回调 loader，返回 this.callback</li>\n<li>this.callback (err,content.sourceMap?,meta?) 可以同步或异步调用，返回多个结果的函数</li>\n<li>this.getOptions (schema) 获取 loader 的配置</li>\n<li>this.emitFile (name,content,sourceMap) 创建一个文件</li>\n<li>this.utils.contextify (context,request) 返回一个相对路径</li>\n<li>this.utils.absolutify (context,request) 返回一个绝对路径</li>\n</ul>\n<h2 id=\"plugin\"><a class=\"markdownIt-Anchor\" href=\"#plugin\">#</a> Plugin</h2>\n<p>通过插件我们可以扩展 webpack，加入自定义的构建行为，使 webpack 可以执行更广泛的任务，拥有更强的构建能力。<br>\nwebpack 在编译代码过程中，会触发一系列 Tapable 钩子事件，插件所做的，就是找到相应的钩子，往上面挂上自己的任务，也就是注册事件，这样，当 webpack 构建的时候，插件注册的事件就会随着钩子的触发而执行了。</p>\n<h3 id=\"tapable\"><a class=\"markdownIt-Anchor\" href=\"#tapable\">#</a> Tapable</h3>\n<p>Tapable 为 webpack 提供了统一的插件接口（钩子）类型定义，它是 webpack 的核心功能库。webpack 中目前有十种 hooks，在 Tapable 源码中可以看到，他们是：</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// https://github.com/webpack/tapable/blob/master/lib/index.js</span></span><br><span class=\"line\"><span class=\"built_in\">exports</span>.<span class=\"property\">SyncHook</span> = <span class=\"built_in\">require</span>(<span class=\"string\">&quot;./SyncHook&quot;</span>);</span><br><span class=\"line\"><span class=\"built_in\">exports</span>.<span class=\"property\">SyncBailHook</span> = <span class=\"built_in\">require</span>(<span class=\"string\">&quot;./SyncBailHook&quot;</span>);</span><br><span class=\"line\"><span class=\"built_in\">exports</span>.<span class=\"property\">SyncWaterfallHook</span> = <span class=\"built_in\">require</span>(<span class=\"string\">&quot;./SyncWaterfallHook&quot;</span>);</span><br><span class=\"line\"><span class=\"built_in\">exports</span>.<span class=\"property\">SyncLoopHook</span> = <span class=\"built_in\">require</span>(<span class=\"string\">&quot;./SyncLoopHook&quot;</span>);</span><br><span class=\"line\"><span class=\"built_in\">exports</span>.<span class=\"property\">AsyncParallelHook</span> = <span class=\"built_in\">require</span>(<span class=\"string\">&quot;./AsyncParallelHook&quot;</span>);</span><br><span class=\"line\"><span class=\"built_in\">exports</span>.<span class=\"property\">AsyncParallelBailHook</span> = <span class=\"built_in\">require</span>(<span class=\"string\">&quot;./AsyncParallelBailHook&quot;</span>);</span><br><span class=\"line\"><span class=\"built_in\">exports</span>.<span class=\"property\">AsyncSeriesHook</span> = <span class=\"built_in\">require</span>(<span class=\"string\">&quot;./AsyncSeriesHook&quot;</span>);</span><br><span class=\"line\"><span class=\"built_in\">exports</span>.<span class=\"property\">AsyncSeriesBailHook</span> = <span class=\"built_in\">require</span>(<span class=\"string\">&quot;./AsyncSeriesBailHook&quot;</span>);</span><br><span class=\"line\"><span class=\"built_in\">exports</span>.<span class=\"property\">AsyncSeriesLoopHook</span> = <span class=\"built_in\">require</span>(<span class=\"string\">&quot;./AsyncSeriesLoopHook&quot;</span>);</span><br><span class=\"line\"><span class=\"built_in\">exports</span>.<span class=\"property\">AsyncSeriesWaterfallHook</span> = <span class=\"built_in\">require</span>(<span class=\"string\">&quot;./AsyncSeriesWaterfallHook&quot;</span>);</span><br><span class=\"line\"><span class=\"built_in\">exports</span>.<span class=\"property\">HookMap</span> = <span class=\"built_in\">require</span>(<span class=\"string\">&quot;./HookMap&quot;</span>);</span><br><span class=\"line\"><span class=\"built_in\">exports</span>.<span class=\"property\">MultiHook</span> = <span class=\"built_in\">require</span>(<span class=\"string\">&quot;./MultiHook&quot;</span>);</span><br></pre></td></tr></table></figure>\n<p>Tapable 还统一暴露了三个方法给插件，用于注入不同类型的自定义构建行为：</p>\n<ul>\n<li>tap：可以注册同步钩子和异步钩子。</li>\n<li>tapAsync：回调方式注册异步钩子。</li>\n<li>tapPromise：Promise 方式注册异步钩子。</li>\n</ul>\n<h3 id=\"plugin-构建对象\"><a class=\"markdownIt-Anchor\" href=\"#plugin-构建对象\">#</a> Plugin 构建对象</h3>\n<h4 id=\"compiler\"><a class=\"markdownIt-Anchor\" href=\"#compiler\">#</a> Compiler</h4>\n<p>compiler 对象中保存着完整的 Webpack 环境配置，每次启动 webpack 构建时它都是一个独一无二，仅仅会创建一次的对象。</p>\n<p>这个对象会在首次启动 Webpack 时创建，我们可以通过 compiler 对象上访问到 Webapck 的主环境配置，比如 loader 、 plugin 等等配置信息。</p>\n<p>它有以下主要属性：</p>\n<ul>\n<li>compiler.options 可以访问本次启动 webpack 时候所有的配置文件，包括但不限于 loaders 、 entry 、 output 、 plugin 等等完整配置信息。</li>\n<li>compiler.inputFileSystem 和 compiler.outputFileSystem 可以进行文件操作，相当于 Nodejs 中 fs。</li>\n<li>compiler.hooks 可以注册 tapable 的不同种类 Hook，从而可以在 compiler 生命周期中植入不同的逻辑。</li>\n</ul>\n<h4 id=\"compilation\"><a class=\"markdownIt-Anchor\" href=\"#compilation\">#</a> Compilation</h4>\n<p>compilation 对象代表一次资源的构建，compilation 实例能够访问所有的模块和它们的依赖。</p>\n<p>一个 compilation 对象会对构建依赖图中所有模块，进行编译。 在编译阶段，模块会被加载 (load)、封存 (seal)、优化 (optimize)、 分块 (chunk)、哈希 (hash) 和重新创建 (restore)。</p>\n<p>它有以下主要属性：</p>\n<ul>\n<li>compilation.modules 可以访问所有模块，打包的每一个文件都是一个模块。</li>\n<li>compilation.chunks chunk 即是多个 modules 组成而来的一个代码块。入口文件引入的资源组成一个 chunk，通过代码分割的模块又是另外的 chunk。</li>\n<li>compilation.assets 可以访问本次打包生成所有文件的结果。</li>\n<li>compilation.hooks 可以注册 tapable 的不同种类 Hook，用于在 compilation 编译模块阶段进行逻辑添加以及修改。</li>\n</ul>\n<h4 id=\"生命周期简图\"><a class=\"markdownIt-Anchor\" href=\"#生命周期简图\">#</a> 生命周期简图</h4>\n<p><img data-src=\"https://yk2012.github.io/sgg_webpack5/imgs/source/plugin.jpg\" alt=\"\"></p>\n<h3 id=\"开发第一个插件\"><a class=\"markdownIt-Anchor\" href=\"#开发第一个插件\">#</a> 开发第一个插件</h3>\n<p>创建  <code>plugins/test-plugin.js</code></p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 1. webpack加载配置,此时new TestPlugin,执行constructor</span></span><br><span class=\"line\"><span class=\"comment\"> * 2. 创建compiler对象</span></span><br><span class=\"line\"><span class=\"comment\"> * 3. 编译所有插件，调用插件的apply方法</span></span><br><span class=\"line\"><span class=\"comment\"> * 4. 执行剩下的编译流程(触发各个hooks事件)</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">TestPlugin</span> &#123;</span><br><span class=\"line\">  <span class=\"title function_\">constructor</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">    <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&quot;test constructor&quot;</span>)</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"title function_\">apply</span>(<span class=\"params\">compiler</span>) &#123;</span><br><span class=\"line\">    <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&quot;test apply&quot;</span>)</span><br><span class=\"line\">    <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(compiler)</span><br><span class=\"line\">    <span class=\"keyword\">debugger</span></span><br><span class=\"line\">    <span class=\"comment\">// 由文档知,environment是同步钩子，需要tap注册</span></span><br><span class=\"line\">    compiler.<span class=\"property\">hooks</span>.<span class=\"property\">environment</span>.<span class=\"title function_\">tap</span>(<span class=\"string\">&quot;TestPlugin&quot;</span>, <span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">      <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&quot;TestPlugin environment&quot;</span>)</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">    <span class=\"comment\">// 由文档知,emit是异步串行钩子(可以异步，但多个异步钩子必须按顺序执行)</span></span><br><span class=\"line\">    compiler.<span class=\"property\">hooks</span>.<span class=\"property\">emit</span>.<span class=\"title function_\">tap</span>(<span class=\"string\">&quot;TestPlugin&quot;</span>, <span class=\"function\">(<span class=\"params\">compilation</span>) =&gt;</span> &#123;</span><br><span class=\"line\">      <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&quot;TestPlugin emit&quot;</span>)</span><br><span class=\"line\">      <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(compilation)</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">    compiler.<span class=\"property\">hooks</span>.<span class=\"property\">emit</span>.<span class=\"title function_\">tapAsync</span>(<span class=\"string\">&quot;TestPlugin&quot;</span>, <span class=\"function\">(<span class=\"params\">compilation, callback</span>) =&gt;</span> &#123;</span><br><span class=\"line\">      <span class=\"built_in\">setTimeout</span>(<span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">        <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&quot;TestPlugin emit async&quot;</span>)</span><br><span class=\"line\">        <span class=\"title function_\">callback</span>() <span class=\"comment\">// 调用callback才代表函数执行完毕</span></span><br><span class=\"line\">      &#125;, <span class=\"number\">2000</span>)</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">    compiler.<span class=\"property\">hooks</span>.<span class=\"property\">emit</span>.<span class=\"title function_\">tapPromise</span>(<span class=\"string\">&quot;TestPlugin&quot;</span>, <span class=\"function\">(<span class=\"params\">compilation</span>) =&gt;</span> &#123;</span><br><span class=\"line\">      <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Promise</span>(<span class=\"function\">(<span class=\"params\">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">setTimeout</span>(<span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">          <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&quot;TestPlugin emit promise&quot;</span>)</span><br><span class=\"line\">          <span class=\"title function_\">resolve</span>()</span><br><span class=\"line\">        &#125;, <span class=\"number\">1000</span>)</span><br><span class=\"line\">      &#125;)</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">    <span class=\"comment\">// 由文档知,make是异步并行钩子(多个异步钩子同时触发,谁先做完谁先调用)</span></span><br><span class=\"line\">    compiler.<span class=\"property\">hooks</span>.<span class=\"property\">make</span>.<span class=\"title function_\">tapAsync</span>(<span class=\"string\">&quot;TestPlugin&quot;</span>, <span class=\"function\">(<span class=\"params\">compilation, callback</span>) =&gt;</span> &#123;</span><br><span class=\"line\">      <span class=\"built_in\">setTimeout</span>(<span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">        <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&quot;TestPlugin make async&quot;</span>)</span><br><span class=\"line\">        <span class=\"comment\">// 需要在compilation hooks触发前注册</span></span><br><span class=\"line\">        compilation.<span class=\"property\">hooks</span>.<span class=\"property\">seal</span>.<span class=\"title function_\">tap</span>(<span class=\"string\">&quot;TestPlugin&quot;</span>, <span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">          <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&quot;TestPlugin seal&quot;</span>)</span><br><span class=\"line\">        &#125;)</span><br><span class=\"line\">        <span class=\"title function_\">callback</span>() <span class=\"comment\">// 调用callback才代表函数执行完毕</span></span><br><span class=\"line\">      &#125;, <span class=\"number\">2000</span>)</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">    compiler.<span class=\"property\">hooks</span>.<span class=\"property\">make</span>.<span class=\"title function_\">tapPromise</span>(<span class=\"string\">&quot;TestPlugin&quot;</span>, <span class=\"function\">(<span class=\"params\">compilation</span>) =&gt;</span> &#123;</span><br><span class=\"line\">      <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Promise</span>(<span class=\"function\">(<span class=\"params\">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">setTimeout</span>(<span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">          <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&quot;TestPlugin make promise&quot;</span>)</span><br><span class=\"line\">          <span class=\"title function_\">resolve</span>()</span><br><span class=\"line\">        &#125;, <span class=\"number\">1000</span>)</span><br><span class=\"line\">      &#125;)</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"variable language_\">module</span>.<span class=\"property\">exports</span> = <span class=\"title class_\">TestPlugin</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"观测compiler-和-compilation\"><a class=\"markdownIt-Anchor\" href=\"#观测compiler-和-compilation\">#</a> 观测 compiler 和 compilation</h3>\n<p>compiler 和 compilation 属性和方法太多，我们难以在终端之中观测，并且也不方便我们学习。</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// package.json</span></span><br><span class=\"line\"><span class=\"string\">&quot;scripts&quot;</span>: &#123;</span><br><span class=\"line\">  <span class=\"string\">&quot;debug&quot;</span>: <span class=\"string\">&quot;node --inspect-brk ./node_modules/webpack-cli/bin/cli.js&quot;</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><strong>启动</strong><br>\n打开任意 Chorme 窗口，f12 启动开发者工具</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm run debug</span><br></pre></td></tr></table></figure>\n<p>然后就会发现开发者工具左上角出现了一个绿色的 node 图标，点进去就会进入 nodejs 的开发者工具</p>\n",
            "tags": []
        },
        {
            "id": "http://example.com/2023/08/18/%E5%89%8D%E7%AB%AF%E5%B7%A5%E7%A8%8B%E5%8C%96/webpack%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97/",
            "url": "http://example.com/2023/08/18/%E5%89%8D%E7%AB%AF%E5%B7%A5%E7%A8%8B%E5%8C%96/webpack%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97/",
            "title": "webpack入门指南",
            "date_published": "2023-08-17T20:12:37.879Z",
            "content_html": "<h2 id=\"为什么需要打包工具\"><a class=\"markdownIt-Anchor\" href=\"#为什么需要打包工具\">#</a> 为什么需要打包工具</h2>\n<blockquote>\n<p>开发时，我们会使用框架 (React, Vue), ES6 模块化语法，Less/Sass 预处理器等语法进行开发，这样代码想要在浏览器运行时必须经过编译成浏览器能识别的 JS, CSS, HTML 等，才能运行。<br>\n所以我们需要打包工具帮助我们完成这些事<br>\n除此，打包工具还能进行压缩代码，做兼容性处理，提升代码性能等</p>\n</blockquote>\n<h2 id=\"基本使用\"><a class=\"markdownIt-Anchor\" href=\"#基本使用\">#</a> 基本使用</h2>\n<blockquote>\n<p>它会以一个或多个文件作为打包的入口，将整个项目所有文件组合成一个或多个文件输出出去。输出的文件就是编译好的文件。<br>\n打包工具一般会输出一个或多个文件，这些文件就是编译后的文件，我们一般会将其称为 bundle</p>\n</blockquote>\n<h2 id=\"功能结束\"><a class=\"markdownIt-Anchor\" href=\"#功能结束\">#</a> 功能结束</h2>\n<p>Webpack 本身功能是有限的</p>\n<ul>\n<li>开发模式：仅能编译 JS 中的  <code>ES Module</code>  语法</li>\n<li>生产模式：能编译 JS 中的  <code>ES Module</code>  语法，还能压缩 JS 代码</li>\n</ul>\n<h2 id=\"创建目录\"><a class=\"markdownIt-Anchor\" href=\"#创建目录\">#</a> 创建目录</h2>\n<figure class=\"highlight text\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">- src</span><br><span class=\"line\">  - main.js</span><br><span class=\"line\">  - js</span><br><span class=\"line\">    - count.js</span><br><span class=\"line\">    - sum.js</span><br><span class=\"line\">- public</span><br><span class=\"line\">    - index.html</span><br></pre></td></tr></table></figure>\n<p>public/index.html</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;!DOCTYPE <span class=\"keyword\">html</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">html</span> <span class=\"attr\">lang</span>=<span class=\"string\">&quot;en&quot;</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">charset</span>=<span class=\"string\">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;viewport&quot;</span> <span class=\"attr\">content</span>=<span class=\"string\">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">title</span>&gt;</span>Webpack<span class=\"tag\">&lt;/<span class=\"name\">title</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">h1</span>&gt;</span>hello webpack<span class=\"tag\">&lt;/<span class=\"name\">h1</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">&quot;../src/main.js&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">html</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p>src/main.js</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> count <span class=\"keyword\">from</span> <span class=\"string\">&quot;./js/count&quot;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> sum <span class=\"keyword\">from</span> <span class=\"string\">&quot;./js/sum&quot;</span></span><br><span class=\"line\"><span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"title function_\">count</span>(<span class=\"number\">2</span>, <span class=\"number\">1</span>))</span><br><span class=\"line\"><span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"title function_\">sum</span>(<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>))</span><br></pre></td></tr></table></figure>\n<p>src/js/count.js</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">default</span> <span class=\"keyword\">function</span> <span class=\"title function_\">count</span>(<span class=\"params\">x, y</span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> x - y</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>src/js/sum.js</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">default</span> <span class=\"keyword\">function</span> <span class=\"title function_\">sum</span>(<span class=\"params\">...args</span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> args.<span class=\"title function_\">reduce</span>(<span class=\"function\">(<span class=\"params\">acc, cur</span>) =&gt;</span> acc + cur, <span class=\"number\">0</span>)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>当我们打开  <code>public/index.html</code>  时，控制台会报错 <code>Uncaught SyntaxError: Cannot use import statement outside a module</code> ，因为浏览器不认识 <code>ES6 Module</code>  的语法。<br>\n这时，我们就需要使用 Webpack 来编译打包我们的代码，使浏览器可以识别。</p>\n<h2 id=\"安装\"><a class=\"markdownIt-Anchor\" href=\"#安装\">#</a> 安装</h2>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm init -y</span><br><span class=\"line\">npm install webpack webpack-cli --save-dev</span><br></pre></td></tr></table></figure>\n<h2 id=\"打包\"><a class=\"markdownIt-Anchor\" href=\"#打包\">#</a> 打包</h2>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npx webpack ./src/main.js --mode=development // 开发模式</span><br></pre></td></tr></table></figure>\n<p>然后就会在根目录下出现一个 dist 目录，里面有一个 main.js 文件，这就是我们打包后的文件。<br>\n我们更改一下我们的 pubilc/index.html 文件，把 <code>&lt;script src=&quot;../src/main.js&quot;&gt;&lt;/script&gt;</code>  改成 <code>&lt;script src=&quot;../dist/main.js&quot;&gt;&lt;/script&gt;</code></p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;!DOCTYPE <span class=\"keyword\">html</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">html</span> <span class=\"attr\">lang</span>=<span class=\"string\">&quot;en&quot;</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">charset</span>=<span class=\"string\">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;viewport&quot;</span> <span class=\"attr\">content</span>=<span class=\"string\">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">title</span>&gt;</span>Webpack<span class=\"tag\">&lt;/<span class=\"name\">title</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">h1</span>&gt;</span>hello webpack<span class=\"tag\">&lt;/<span class=\"name\">h1</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">&quot;../dist/main.js&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">html</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p>然后浏览器就可以运行了。<br>\n当你查看 dist/main.js 文件时，会发现里面多了很多东西，我们看不懂。<br>\n我们现在使用生产模式进行打包，生产模式会进行代码压缩。</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npx webpack ./src/main.js --mode=production //  生产模式</span><br></pre></td></tr></table></figure>\n<p>压缩之后的代码</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">;(<span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">  <span class=\"string\">&quot;use strict&quot;</span></span><br><span class=\"line\">  <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"number\">1</span>), <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>([<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>].<span class=\"title function_\">reduce</span>(<span class=\"function\">(<span class=\"params\">o, e</span>) =&gt;</span> o + e, <span class=\"number\">0</span>))</span><br><span class=\"line\">&#125;)()</span><br></pre></td></tr></table></figure>\n<h2 id=\"核心概念\"><a class=\"markdownIt-Anchor\" href=\"#核心概念\">#</a> 核心概念</h2>\n<ul>\n<li>entry：入口文件，Webpack 执行构建的第一步从 entry 开始，可抽象成输入。</li>\n<li>output：输出文件，Webpack 执行构建的最后一步输出文件，可抽象成输出。</li>\n<li>module：模块，在 Webpack 里一切皆模块，一个模块对应着一个文件。</li>\n<li>loader：webpack 本身只能处理 JavaScript 模块，如果要处理其他类型的文件，就需要配置 loader 转换器。</li>\n<li>plugin：扩展插件，在 Webpack 构建流程中的特定时机注入扩展逻辑。</li>\n<li>mode: 模式，模式指定了 webpack 使用相应环境下的配置。</li>\n</ul>\n<h2 id=\"配置文件\"><a class=\"markdownIt-Anchor\" href=\"#配置文件\">#</a> 配置文件</h2>\n<p>名字固定:  <code>webpack.config.js</code> <br>\n 配置文件都是在  <code>nodeJS</code>  环境下运行的，都是 <code>CommonJS</code>  规范。</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// webpack.config.js</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> path = <span class=\"built_in\">require</span>(<span class=\"string\">&quot;path&quot;</span>)</span><br><span class=\"line\"><span class=\"variable language_\">module</span>.<span class=\"property\">exports</span> = &#123;</span><br><span class=\"line\">  <span class=\"comment\">// 入口</span></span><br><span class=\"line\">  <span class=\"attr\">entry</span>: <span class=\"string\">&quot;./src/main.js&quot;</span>, <span class=\"comment\">// 相对路径</span></span><br><span class=\"line\">  <span class=\"comment\">// 输出</span></span><br><span class=\"line\">  <span class=\"attr\">output</span>: &#123;</span><br><span class=\"line\">    <span class=\"comment\">// 文件的输出路径</span></span><br><span class=\"line\">    <span class=\"comment\">// __dirname代表当前文件的文件夹目录</span></span><br><span class=\"line\">    <span class=\"attr\">path</span>: path.<span class=\"title function_\">resolve</span>(__dirname, <span class=\"string\">&quot;dist&quot;</span>), <span class=\"comment\">// 绝对路径</span></span><br><span class=\"line\">    <span class=\"comment\">// 文件名</span></span><br><span class=\"line\">    <span class=\"attr\">filename</span>: <span class=\"string\">&quot;main.js&quot;</span>,</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  <span class=\"comment\">// 加载器</span></span><br><span class=\"line\">  <span class=\"attr\">module</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">rules</span>: [</span><br><span class=\"line\">      <span class=\"comment\">// loader的配置</span></span><br><span class=\"line\">    ],</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  <span class=\"comment\">// 插件</span></span><br><span class=\"line\">  <span class=\"attr\">plugins</span>: [</span><br><span class=\"line\">    <span class=\"comment\">// plugin的配置</span></span><br><span class=\"line\">  ],</span><br><span class=\"line\">  <span class=\"comment\">// 模式</span></span><br><span class=\"line\">  <span class=\"attr\">mode</span>: <span class=\"string\">&quot;development&quot;</span>, <span class=\"comment\">// 开发环境</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>有了配置文件，打包命令就可以简化了</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npx webpack</span><br></pre></td></tr></table></figure>\n<h2 id=\"处理样式资源\"><a class=\"markdownIt-Anchor\" href=\"#处理样式资源\">#</a> 处理样式资源</h2>\n<p>Webpack 本身只能处理 JavaScript 模块，如果要处理其他类型的文件，就需要配置 loader 转换器。</p>\n<h3 id=\"处理-css-资源\"><a class=\"markdownIt-Anchor\" href=\"#处理-css-资源\">#</a> 处理 CSS 资源</h3>\n<p>添加  <code>src/css/index.css</code>  文件</p>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-class\">.box1</span> &#123;</span><br><span class=\"line\">  <span class=\"attribute\">width</span>: <span class=\"number\">100px</span>;</span><br><span class=\"line\">  <span class=\"attribute\">height</span>: <span class=\"number\">100px</span>;</span><br><span class=\"line\">  <span class=\"attribute\">background</span>: pink;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>修改  <code>src/main.js</code></p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> count <span class=\"keyword\">from</span> <span class=\"string\">&quot;./js/count&quot;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> sum <span class=\"keyword\">from</span> <span class=\"string\">&quot;./js/sum&quot;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> <span class=\"string\">&quot;./css/index.css&quot;</span></span><br><span class=\"line\"><span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"title function_\">count</span>(<span class=\"number\">2</span>, <span class=\"number\">1</span>))</span><br><span class=\"line\"><span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"title function_\">sum</span>(<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>))</span><br></pre></td></tr></table></figure>\n<p>安装  <code>css-loader</code></p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm i css-loader style-loader -D</span><br></pre></td></tr></table></figure>\n<p>然后在配置文件中配置  <code>css-loader</code></p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// webpack.config.js</span></span><br><span class=\"line\"><span class=\"comment\">// 加载器</span></span><br><span class=\"line\">  <span class=\"attr\">module</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">rules</span>: [</span><br><span class=\"line\">      <span class=\"comment\">// loader的配置</span></span><br><span class=\"line\">      &#123;</span><br><span class=\"line\">        <span class=\"attr\">test</span>: <span class=\"regexp\">/\\.css$/</span>, <span class=\"comment\">// 只检测.css结尾的文件,当匹配时调用use</span></span><br><span class=\"line\">        <span class=\"comment\">// use执行顺序从右到左，从下到上</span></span><br><span class=\"line\">        <span class=\"attr\">use</span>: [</span><br><span class=\"line\">          <span class=\"string\">&quot;style-loader&quot;</span>, <span class=\"comment\">// 将js中css通过创建style标签的形式添加到html文件中</span></span><br><span class=\"line\">          <span class=\"string\">&quot;css-loader&quot;</span>, <span class=\"comment\">// 将css资源编译成commonjs的模块到js中</span></span><br><span class=\"line\">        ],</span><br><span class=\"line\">      &#125;,</span><br><span class=\"line\">    ],</span><br><span class=\"line\">  &#125;,</span><br></pre></td></tr></table></figure>\n<h3 id=\"处理less资源\"><a class=\"markdownIt-Anchor\" href=\"#处理less资源\">#</a> 处理 less 资源</h3>\n<p>添加  <code>src/less/index.less</code>  文件</p>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-class\">.box2</span> &#123;</span><br><span class=\"line\">  <span class=\"attribute\">width</span>: <span class=\"number\">100px</span>;</span><br><span class=\"line\">  <span class=\"attribute\">height</span>: <span class=\"number\">100px</span>;</span><br><span class=\"line\">  <span class=\"attribute\">background</span>: deeppink;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>修改  <code>src/main.js</code></p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> count <span class=\"keyword\">from</span> <span class=\"string\">&quot;./js/count&quot;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> sum <span class=\"keyword\">from</span> <span class=\"string\">&quot;./js/sum&quot;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> <span class=\"string\">&quot;./css/index.css&quot;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> <span class=\"string\">&quot;./less/index.less&quot;</span></span><br><span class=\"line\"><span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"title function_\">count</span>(<span class=\"number\">2</span>, <span class=\"number\">1</span>))</span><br><span class=\"line\"><span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"title function_\">sum</span>(<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>))</span><br></pre></td></tr></table></figure>\n<p>安装  <code>less-loader</code></p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm i less-loader less -D</span><br></pre></td></tr></table></figure>\n<p>修改配置文件</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// webpack.config.js</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"attr\">test</span>: <span class=\"regexp\">/\\.less$/i</span>,</span><br><span class=\"line\">  <span class=\"attr\">use</span>: [</span><br><span class=\"line\">    <span class=\"comment\">// compiles Less to CSS</span></span><br><span class=\"line\">    <span class=\"string\">&quot;style-loader&quot;</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;css-loader&quot;</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;less-loader&quot;</span>,</span><br><span class=\"line\">  ],</span><br><span class=\"line\">&#125;,</span><br></pre></td></tr></table></figure>\n<h3 id=\"处理sass资源\"><a class=\"markdownIt-Anchor\" href=\"#处理sass资源\">#</a> 处理 sass 资源</h3>\n<p>修改  <code>src/sass/index.scss</code>  文件</p>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-class\">.box3</span> &#123;</span><br><span class=\"line\">  <span class=\"attribute\">width</span>: <span class=\"number\">100px</span>;</span><br><span class=\"line\">  <span class=\"attribute\">height</span>: <span class=\"number\">100px</span>;</span><br><span class=\"line\">  <span class=\"attribute\">background</span>: hotpink;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>修改  <code>src/main.js</code></p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> count <span class=\"keyword\">from</span> <span class=\"string\">&quot;./js/count&quot;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> sum <span class=\"keyword\">from</span> <span class=\"string\">&quot;./js/sum&quot;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> <span class=\"string\">&quot;./css/index.css&quot;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> <span class=\"string\">&quot;./less/index.less&quot;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> <span class=\"string\">&quot;./sass/index.scss&quot;</span></span><br><span class=\"line\"><span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"title function_\">count</span>(<span class=\"number\">2</span>, <span class=\"number\">1</span>))</span><br><span class=\"line\"><span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"title function_\">sum</span>(<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>))</span><br></pre></td></tr></table></figure>\n<p>安装  <code>sass-loader</code></p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm i sass-loader sass -D</span><br></pre></td></tr></table></figure>\n<p>修改配置文件</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// webpack.config.js</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"attr\">test</span>: <span class=\"regexp\">/\\.s[ac]ss$/i</span>,</span><br><span class=\"line\">  <span class=\"attr\">use</span>: [</span><br><span class=\"line\">    <span class=\"comment\">// 将 JS 字符串生成为 style 节点</span></span><br><span class=\"line\">    <span class=\"string\">&quot;style-loader&quot;</span>,</span><br><span class=\"line\">    <span class=\"comment\">// 将 CSS 转化成 CommonJS 模块</span></span><br><span class=\"line\">    <span class=\"string\">&quot;css-loader&quot;</span>,</span><br><span class=\"line\">    <span class=\"comment\">// 将 Sass 编译成 CSS</span></span><br><span class=\"line\">    <span class=\"string\">&quot;sass-loader&quot;</span>,</span><br><span class=\"line\">  ],</span><br><span class=\"line\">&#125;,</span><br></pre></td></tr></table></figure>\n<h3 id=\"处理图片资源\"><a class=\"markdownIt-Anchor\" href=\"#处理图片资源\">#</a> 处理图片资源</h3>\n<p>webpack5 内置了 file-loader 和 url-loader，所以不需要再安装，会自动处理。<br>\n但我们有时需要对其进行一些优化。<br>\n添加  <code>src/images/1.png</code> <br>\n 修改  <code>src/css/index.css</code></p>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-class\">.box1</span> &#123;</span><br><span class=\"line\">  <span class=\"attribute\">width</span>: <span class=\"number\">100px</span>;</span><br><span class=\"line\">  <span class=\"attribute\">height</span>: <span class=\"number\">100px</span>;</span><br><span class=\"line\">  <span class=\"attribute\">background</span>: pink;</span><br><span class=\"line\">  <span class=\"attribute\">background-image</span>: <span class=\"built_in\">url</span>(<span class=\"string\">&#x27;../images/1.png&#x27;</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>修改  <code>public/index.html</code></p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;!DOCTYPE <span class=\"keyword\">html</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">html</span> <span class=\"attr\">lang</span>=<span class=\"string\">&quot;en&quot;</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">charset</span>=<span class=\"string\">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;viewport&quot;</span> <span class=\"attr\">content</span>=<span class=\"string\">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">title</span>&gt;</span>Webpack<span class=\"tag\">&lt;/<span class=\"name\">title</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">h1</span>&gt;</span>hello webpack<span class=\"tag\">&lt;/<span class=\"name\">h1</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;box1&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;box2&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;box3&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">&quot;../dist/main.js&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">html</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p><strong>需求</strong>：我们想把小图片转为 base64, 减少 http 请求。大图片不转换为 base64, 减少打包体积。<br>\n修改配置文件</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// webpack.config.js</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"attr\">test</span>: <span class=\"regexp\">/\\.(png|jpg|gif|jpeg)$/</span>,</span><br><span class=\"line\">  <span class=\"attr\">type</span>: <span class=\"string\">&quot;asset&quot;</span>,</span><br><span class=\"line\">  <span class=\"attr\">parser</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">dataUrlCondition</span>: &#123;</span><br><span class=\"line\">      <span class=\"comment\">// 小于8kb的图片转base64</span></span><br><span class=\"line\">      <span class=\"attr\">maxSize</span>: <span class=\"number\">8</span> * <span class=\"number\">1024</span>, <span class=\"comment\">// 8kb</span></span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">&#125;,</span><br></pre></td></tr></table></figure>\n<h3 id=\"修改输出目录\"><a class=\"markdownIt-Anchor\" href=\"#修改输出目录\">#</a> 修改输出目录</h3>\n<p>当打包的文件多了，如果都打包到一个文件下，会显得很乱<br>\n所以需要进行输出目录配置</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// webpack.config.js</span></span><br><span class=\"line\"><span class=\"variable language_\">module</span>.<span class=\"property\">exports</span> = &#123;</span><br><span class=\"line\">  <span class=\"comment\">// ...</span></span><br><span class=\"line\">  <span class=\"comment\">// 输出</span></span><br><span class=\"line\">  <span class=\"attr\">output</span>: &#123;</span><br><span class=\"line\">    <span class=\"comment\">// 文件的输出路径</span></span><br><span class=\"line\">    <span class=\"comment\">// __dirname代表当前文件的文件夹目录</span></span><br><span class=\"line\">    <span class=\"attr\">path</span>: path.<span class=\"title function_\">resolve</span>(__dirname, <span class=\"string\">&quot;dist&quot;</span>), <span class=\"comment\">// 绝对路径</span></span><br><span class=\"line\">    <span class=\"comment\">// 入口文件(一般为js文件)打包输出文件名</span></span><br><span class=\"line\">    <span class=\"attr\">filename</span>: <span class=\"string\">&quot;static/js/main.js&quot;</span>,</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  <span class=\"comment\">// 加载器</span></span><br><span class=\"line\">  <span class=\"attr\">module</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">rules</span>: [</span><br><span class=\"line\">      <span class=\"comment\">// ...</span></span><br><span class=\"line\">      &#123;</span><br><span class=\"line\">        <span class=\"attr\">test</span>: <span class=\"regexp\">/\\.(png|jpg|gif|jpeg)$/</span>,</span><br><span class=\"line\">        <span class=\"attr\">type</span>: <span class=\"string\">&quot;asset&quot;</span>,</span><br><span class=\"line\">        <span class=\"attr\">parser</span>: &#123;</span><br><span class=\"line\">          <span class=\"attr\">dataUrlCondition</span>: &#123;</span><br><span class=\"line\">            <span class=\"comment\">// 小于8kb的图片转base64</span></span><br><span class=\"line\">            <span class=\"attr\">maxSize</span>: <span class=\"number\">8</span> * <span class=\"number\">1024</span>, <span class=\"comment\">// 8kb</span></span><br><span class=\"line\">          &#125;,</span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">        <span class=\"attr\">generator</span>: &#123;</span><br><span class=\"line\">          <span class=\"comment\">// 输出图片名称</span></span><br><span class=\"line\">          <span class=\"attr\">filename</span>: <span class=\"string\">&quot;static/images/[hash:10][ext][query]&quot;</span>, <span class=\"comment\">// 图片名称,[hash:10]表示hash值的长度为10位,[ext]表示文件后缀,[query]表示文件名</span></span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">      &#125;,</span><br><span class=\"line\">    ],</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"清空上次打包内容\"><a class=\"markdownIt-Anchor\" href=\"#清空上次打包内容\">#</a> 清空上次打包内容</h3>\n<p>如果我们不加以配置，每次观看最新的打包效果，都需要手动删除之前的 dist 文件夹，这样很麻烦，所以需要配置清空上次打包内容。</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// webpack.config.js</span></span><br><span class=\"line\"><span class=\"comment\">// 输出</span></span><br><span class=\"line\">  <span class=\"attr\">output</span>: &#123;</span><br><span class=\"line\">    <span class=\"comment\">// 文件的输出路径</span></span><br><span class=\"line\">    <span class=\"comment\">// __dirname代表当前文件的文件夹目录</span></span><br><span class=\"line\">    <span class=\"attr\">path</span>: path.<span class=\"title function_\">resolve</span>(__dirname, <span class=\"string\">&quot;dist&quot;</span>), <span class=\"comment\">// 绝对路径</span></span><br><span class=\"line\">    <span class=\"comment\">// 入口文件(一般为js文件)打包输出文件名</span></span><br><span class=\"line\">    <span class=\"attr\">filename</span>: <span class=\"string\">&quot;static/js/main.js&quot;</span>,</span><br><span class=\"line\">    <span class=\"attr\">clean</span>: <span class=\"literal\">true</span>, <span class=\"comment\">// 打包前先清空输出目录</span></span><br><span class=\"line\">  &#125;,</span><br></pre></td></tr></table></figure>\n<h3 id=\"处理字体图标资源\"><a class=\"markdownIt-Anchor\" href=\"#处理字体图标资源\">#</a> 处理字体图标资源</h3>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// webpack.config.js</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"attr\">test</span>: <span class=\"regexp\">/\\.(woff|woff2|eot|ttf|otf)$/</span>,</span><br><span class=\"line\">  <span class=\"attr\">type</span>: <span class=\"string\">&quot;asset/resource&quot;</span>,</span><br><span class=\"line\">  <span class=\"attr\">generator</span>: &#123;</span><br><span class=\"line\">    <span class=\"comment\">// 输出图片名称</span></span><br><span class=\"line\">    <span class=\"attr\">filename</span>: <span class=\"string\">&quot;static/media/[hash][ext][query]&quot;</span>, <span class=\"comment\">// 图片名称</span></span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">&#125;,</span><br></pre></td></tr></table></figure>\n<h3 id=\"处理其他资源\"><a class=\"markdownIt-Anchor\" href=\"#处理其他资源\">#</a> 处理其他资源</h3>\n<p>比如音视频等资源<br>\n在处理字体图标资源的 test 匹配后面加相关后缀即可</p>\n<h3 id=\"处理js资源\"><a class=\"markdownIt-Anchor\" href=\"#处理js资源\">#</a> 处理 js 资源</h3>\n<p>Webpack 本身对于 js 的处理是有限的，只能处理 ES 模块化语法，所以我们需要进行一些处理。</p>\n<ul>\n<li>针对 js 兼容性采用 Babel 来完成</li>\n<li>针对代码格式，采用 Eslint 来完成</li>\n</ul>\n<h3 id=\"eslint\"><a class=\"markdownIt-Anchor\" href=\"#eslint\">#</a> eslint</h3>\n<p>可组装的 JavaScript 和 JSX 检查工具。<br>\n关键是写 eslint 的配置文件<br>\n<strong>安装</strong></p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm i eslint eslint-webpack-plugin -D</span><br></pre></td></tr></table></figure>\n<p>修改配置文件</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// webpack.config.js</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"title class_\">ESLintPlugin</span> = <span class=\"built_in\">require</span>(<span class=\"string\">&quot;eslint-webpack-plugin&quot;</span>)</span><br><span class=\"line\"><span class=\"comment\">// 插件</span></span><br><span class=\"line\">  <span class=\"attr\">plugins</span>: [</span><br><span class=\"line\">    <span class=\"comment\">// plugin的配置</span></span><br><span class=\"line\">    <span class=\"keyword\">new</span> <span class=\"title class_\">ESLintPlugin</span>(&#123;</span><br><span class=\"line\">      <span class=\"comment\">// 指定检测的文件</span></span><br><span class=\"line\">      <span class=\"attr\">context</span>: path.<span class=\"title function_\">resolve</span>(__dirname, <span class=\"string\">&quot;src&quot;</span>),</span><br><span class=\"line\">    &#125;),</span><br><span class=\"line\">  ],</span><br></pre></td></tr></table></figure>\n<p>添加 eslint 配置文件</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// .eslintrc or .eslintrc.js or .eslintrc.json区别在于配置格式不一样</span></span><br><span class=\"line\"><span class=\"comment\">// .eslintrc.js</span></span><br><span class=\"line\"><span class=\"variable language_\">module</span>.<span class=\"property\">exports</span> = &#123;</span><br><span class=\"line\">  <span class=\"comment\">// 继承 Eslint 规则</span></span><br><span class=\"line\">  <span class=\"attr\">extends</span>: [<span class=\"string\">&quot;eslint:recommended&quot;</span>],</span><br><span class=\"line\">  <span class=\"attr\">env</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">node</span>: <span class=\"literal\">true</span>, <span class=\"comment\">// 启用node中的全局变量</span></span><br><span class=\"line\">    <span class=\"attr\">browser</span>: <span class=\"literal\">true</span>, <span class=\"comment\">// 启用浏览器中的全局变量</span></span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  <span class=\"attr\">parserOptions</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">ecmaVersion</span>: <span class=\"number\">6</span>, <span class=\"comment\">// 指定ECMAScript的版本</span></span><br><span class=\"line\">    <span class=\"attr\">sourceType</span>: <span class=\"string\">&quot;module&quot;</span>, <span class=\"comment\">// 指定源代码的类型，module表示CommonJS的模块化规范，script表示ECMAScript的规范</span></span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  <span class=\"attr\">rules</span>: &#123;</span><br><span class=\"line\">    <span class=\"string\">&quot;no-var&quot;</span>: <span class=\"number\">2</span>, <span class=\"comment\">// 不能使用 var 定义变量</span></span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><code>.eslintignore</code>  可以配置忽略检查的目录</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">dist</span><br><span class=\"line\">node_modules</span><br></pre></td></tr></table></figure>\n<h3 id=\"babel\"><a class=\"markdownIt-Anchor\" href=\"#babel\">#</a> babel</h3>\n<p>主要用于将 ES6 语法编写的代码转换为向后兼容的代码</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// babel.config.js or babel.config.json or .babalrc or .babalrc.js or .babalrc.json</span></span><br><span class=\"line\"><span class=\"comment\">// babel.config.js</span></span><br><span class=\"line\"><span class=\"variable language_\">module</span>.<span class=\"property\">exports</span> = &#123;</span><br><span class=\"line\">  <span class=\"comment\">// 智能预设，能编译ES6语法</span></span><br><span class=\"line\">  <span class=\"attr\">presets</span>: [<span class=\"string\">&quot;@babel/preset-env&quot;</span>],</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><strong>安装</strong></p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm i babel-loader @babel/core @babel/preset-env -D</span><br></pre></td></tr></table></figure>\n<p><strong>配置</strong></p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// webpack.config.js</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"attr\">test</span>: <span class=\"regexp\">/\\.js$/</span>,</span><br><span class=\"line\">  <span class=\"attr\">exclude</span>: <span class=\"regexp\">/node_modules/</span>, <span class=\"comment\">// 排除node_modules的js文件不处理</span></span><br><span class=\"line\">  <span class=\"attr\">loader</span>: <span class=\"string\">&quot;babel-loader&quot;</span>, <span class=\"comment\">// 使用babel-loader</span></span><br><span class=\"line\">&#125;,</span><br></pre></td></tr></table></figure>\n<h3 id=\"处理-html-资源\"><a class=\"markdownIt-Anchor\" href=\"#处理-html-资源\">#</a> 处理 html 资源</h3>\n<p>我们希望有一个插件来自动引入 script，而不是自己手动修改  <code>index.html</code>  文件<br>\n<strong>安装</strong></p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm i html-webpack-plugin -D</span><br></pre></td></tr></table></figure>\n<p><strong>配置</strong></p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// webpack.config.js</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"title class_\">HtmlWebpackPlugin</span> = <span class=\"built_in\">require</span>(<span class=\"string\">&quot;html-webpack-plugin&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">new</span> <span class=\"title class_\">HtmlWebpackPlugin</span>(&#123;</span><br><span class=\"line\">      <span class=\"comment\">// 模板，以public/index.html文件创建心得html文件</span></span><br><span class=\"line\">      <span class=\"comment\">// 1. 结构和原来一致，会自动引入打包的资源</span></span><br><span class=\"line\">      <span class=\"attr\">template</span>: path.<span class=\"title function_\">resolve</span>(__dirname, <span class=\"string\">&quot;public/index.html&quot;</span>),</span><br><span class=\"line\">    &#125;),</span><br></pre></td></tr></table></figure>\n<h2 id=\"搭建开发服务器\"><a class=\"markdownIt-Anchor\" href=\"#搭建开发服务器\">#</a> 搭建开发服务器</h2>\n<p>每次改代码都需要打包才能看到效果，实在是太麻烦了，我们希望每次保存之后自动重新打包。<br>\n<strong>安装</strong></p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm i webpack-dev-server -D</span><br></pre></td></tr></table></figure>\n<p><strong>配置</strong></p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// webpack.config.js</span></span><br><span class=\"line\"><span class=\"attr\">devServer</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">host</span>: <span class=\"string\">&quot;127.0.0.1&quot;</span>, <span class=\"comment\">// 主机地址</span></span><br><span class=\"line\">    <span class=\"attr\">port</span>: <span class=\"number\">3000</span>, <span class=\"comment\">// 端口</span></span><br><span class=\"line\">    <span class=\"attr\">open</span>: <span class=\"literal\">true</span>, <span class=\"comment\">// 自动打开浏览器</span></span><br><span class=\"line\">  &#125;,</span><br></pre></td></tr></table></figure>\n<p><strong>启动</strong></p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npx webpack serve</span><br></pre></td></tr></table></figure>\n<h2 id=\"生产模式优化\"><a class=\"markdownIt-Anchor\" href=\"#生产模式优化\">#</a> 生产模式优化</h2>\n<p>我们把生产模式和开发模式分别用配置文件<br>\n创建  <code>config</code>  目录<br>\n把  <code>webpack.config.js</code>  移入  <code>config</code>  目录，并改名为  <code>webpack.config.dev.js</code> <br>\n 再复制一份  <code>webpack.config.dev.js</code>  改名为  <code>webpack.config.prod.js</code> <br>\n <code>webpack.config.prod.js</code>  和 <code>webpack.config.dev.js</code>  中所有绝对路径都需要回退一层目录<br>\n <code>webpack.config.prod.js</code>  不需要 <code>devServer</code> , 可以删除， <code>mode</code>  改为 &quot;production&quot;<br>\n <code>webpack.config.dev.js</code>  修改  <code>output</code>  的绝对路径</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">path</span>: <span class=\"literal\">undefined</span>,<span class=\"comment\">// 开发模式没有输出</span></span><br></pre></td></tr></table></figure>\n<p>运行某个配置文件</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npx webpack --config config/webpack.config.prod.js</span><br><span class=\"line\">npx webpack server --config config/webpack.config.dev.js</span><br></pre></td></tr></table></figure>\n<h3 id=\"提取-css-为单独文件\"><a class=\"markdownIt-Anchor\" href=\"#提取-css-为单独文件\">#</a> 提取 CSS 为单独文件</h3>\n<p>现在 CSS 是通过 js 进行添加，这会导致闪屏现象<br>\n<strong>安装</strong></p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm i mini-css-extract-plugin -D</span><br></pre></td></tr></table></figure>\n<p><strong>配置</strong></p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// config/webpack.config.prod.js</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"title class_\">MiniCssExtractPlugin</span> = <span class=\"built_in\">require</span>(<span class=\"string\">&quot;mini-css-extract-plugin&quot;</span>);</span><br><span class=\"line\"><span class=\"comment\">// 把所有的 &quot;style-loader&quot; 替换成 MiniCssExtractPlugin.loader</span></span><br><span class=\"line\"><span class=\"comment\">// ...</span></span><br><span class=\"line\"><span class=\"keyword\">new</span> <span class=\"title class_\">MiniCssExtractPlugin</span>(&#123;</span><br><span class=\"line\">      <span class=\"attr\">filename</span>: <span class=\"string\">&quot;static/css/main.css&quot;</span>,</span><br><span class=\"line\">    &#125;)</span><br></pre></td></tr></table></figure>\n<h3 id=\"css-兼容性处理\"><a class=\"markdownIt-Anchor\" href=\"#css-兼容性处理\">#</a> CSS 兼容性处理</h3>\n<p><strong>安装</strong></p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm i postcss-loader postcss postcss-preset-env -D</span><br></pre></td></tr></table></figure>\n<p>postcss 要在  <code>css-loader</code>  后面，在  <code>less-loader</code>  前面</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"attr\">loader</span>: <span class=\"string\">&quot;postcss-loader&quot;</span>,</span><br><span class=\"line\">  <span class=\"attr\">options</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">postcssOptions</span>: &#123;</span><br><span class=\"line\">      <span class=\"attr\">plugins</span>: [</span><br><span class=\"line\">        <span class=\"string\">&quot;postcss-preset-env&quot;</span>, <span class=\"comment\">// 解决大多数样式兼容问题</span></span><br><span class=\"line\">      ],</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">&#125;,</span><br></pre></td></tr></table></figure>\n<p>这里要看到效果还需要修改  <code>package.json</code></p>\n<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">&quot;browserslist&quot;</span><span class=\"punctuation\">:</span><span class=\"punctuation\">[</span></span><br><span class=\"line\">    <span class=\"string\">&quot;last 2 version&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"string\">&quot;&gt; 1%&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"string\">&quot;not dead&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">  <span class=\"punctuation\">]</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"压缩-css\"><a class=\"markdownIt-Anchor\" href=\"#压缩-css\">#</a> 压缩 CSS</h3>\n<p><strong>安装</strong></p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm i css-minimizer-webpack-plugin -D</span><br></pre></td></tr></table></figure>\n<p><strong>配置</strong></p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// config/webpack.config.prod.js</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"title class_\">CssMinimizerPlugin</span> = <span class=\"built_in\">require</span>(<span class=\"string\">&quot;css-minimizer-webpack-plugin&quot;</span>);</span><br><span class=\"line\"><span class=\"comment\">// ...</span></span><br><span class=\"line\"><span class=\"keyword\">new</span> <span class=\"title class_\">CssMinimizerPlugin</span>()</span><br></pre></td></tr></table></figure>\n<h3 id=\"压缩-js-和-html\"><a class=\"markdownIt-Anchor\" href=\"#压缩-js-和-html\">#</a> 压缩 JS 和 html</h3>\n<p>默认生产模式会对 JS 和 html 进行压缩</p>\n<h2 id=\"提升开发体验优化\"><a class=\"markdownIt-Anchor\" href=\"#提升开发体验优化\">#</a> 提升开发体验优化</h2>\n<h3 id=\"source-map源代码映射\"><a class=\"markdownIt-Anchor\" href=\"#source-map源代码映射\">#</a> Source Map (源代码映射)</h3>\n<p>打包之后的代码我们很难看懂，不好调试，我们希望我们可以去调试打包之后的代码，以提高开发体验。<br>\nSourceMap 会生成 xx.map，里面包含源代码和构建后代码每一行的映射关系，浏览器在运行打包后的代码时，如果遇到报错，会去查找对应的 SourceMap 文件，然后把报错位置映射到源代码上，这样就便于我们进行调试了。<br>\nSourceMap 有很多格式，但实际开发只需要关注两种情况</p>\n<ul>\n<li>开发模式：cheap-module-source-map<br>\n 打包速度快，只包含行映射</li>\n</ul>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// config/webpack.config.dev.js</span></span><br><span class=\"line\"><span class=\"variable language_\">module</span>.<span class=\"property\">exports</span> = &#123;</span><br><span class=\"line\">  <span class=\"comment\">// ...</span></span><br><span class=\"line\">  <span class=\"attr\">devtool</span>: <span class=\"string\">&quot;cheap-module-source-map&quot;</span>,</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<ul>\n<li>生产模式：source-map<br>\n 包含列，行，源代码，构建后代码的源代码位置映射，但打包速度慢</li>\n</ul>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// config/webpack.config.prod.js</span></span><br><span class=\"line\"><span class=\"variable language_\">module</span>.<span class=\"property\">exports</span> = &#123;</span><br><span class=\"line\">  <span class=\"comment\">// ...</span></span><br><span class=\"line\">  <span class=\"attr\">devtool</span>: <span class=\"string\">&quot;source-map&quot;</span>,</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"hotmodulereplacementhmr\"><a class=\"markdownIt-Anchor\" href=\"#hotmodulereplacementhmr\">#</a> HotModuleReplacement(HMR)</h3>\n<p>HMR 允许在运行时更新各种模块，而无需完全刷新。<br>\n原本更改一个模块会重新打包所有模块，HMR 会使用之前打包的结果，只更新有变化的模块，大大提高了开发效率。</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">devServer</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">host</span>: <span class=\"string\">&quot;127.0.0.1&quot;</span>, <span class=\"comment\">// 主机地址</span></span><br><span class=\"line\">    <span class=\"attr\">port</span>: <span class=\"number\">3000</span>, <span class=\"comment\">// 端口</span></span><br><span class=\"line\">    <span class=\"attr\">open</span>: <span class=\"literal\">true</span>, <span class=\"comment\">// 自动打开浏览器</span></span><br><span class=\"line\">    <span class=\"attr\">hot</span>: <span class=\"literal\">true</span>, <span class=\"comment\">// 开启HMR</span></span><br><span class=\"line\">  &#125;,</span><br></pre></td></tr></table></figure>\n<p>在 Webpack5 中，HMR 默认是开启的，不需要进行显式的配置<br>\n但 js 更改还是会整页刷新，如果想要 js 也开启</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 如果支持热更新</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> count <span class=\"keyword\">from</span> <span class=\"string\">&quot;./js/count.js&quot;</span></span><br><span class=\"line\"><span class=\"keyword\">if</span>(<span class=\"variable language_\">module</span>.<span class=\"property\">hot</span>) &#123;</span><br><span class=\"line\">  <span class=\"variable language_\">module</span>.<span class=\"property\">hot</span>.<span class=\"title function_\">accept</span>(<span class=\"string\">&quot;./js/count.js&quot;</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>上面这样写会很麻烦<br>\n在实际开发中我们会使用其他 loader 来解决<br>\n比如：  <code>vue-loader</code> , <code>react-hot-loader</code></p>\n<h3 id=\"oneof\"><a class=\"markdownIt-Anchor\" href=\"#oneof\">#</a> OneOf</h3>\n<p>OneOf 可以让 loader 只运行一次，如果多个 loader 对同一个文件生效，那么只会运行第一个，后面的会被忽略。</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"variable language_\">module</span>.<span class=\"property\">exports</span> = &#123;</span><br><span class=\"line\">  <span class=\"attr\">module</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">rules</span>: [</span><br><span class=\"line\">      <span class=\"comment\">// 每个文件只能被其中一个loader处理</span></span><br><span class=\"line\">      <span class=\"attr\">oneOf</span>: [</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">        <span class=\"attr\">test</span>: <span class=\"regexp\">/\\.css$/</span>,</span><br><span class=\"line\">        <span class=\"attr\">use</span>: [</span><br><span class=\"line\">          &#123;</span><br><span class=\"line\">            <span class=\"attr\">loader</span>: <span class=\"string\">&quot;style-loader&quot;</span>,</span><br><span class=\"line\">          &#125;,</span><br><span class=\"line\">          &#123;</span><br><span class=\"line\">            <span class=\"attr\">loader</span>: <span class=\"string\">&quot;css-loader&quot;</span>,</span><br><span class=\"line\">          &#125;,</span><br><span class=\"line\">        ],</span><br><span class=\"line\">      &#125;,</span><br><span class=\"line\">      &#123;</span><br><span class=\"line\">        <span class=\"attr\">test</span>: <span class=\"regexp\">/\\.css$/</span>,</span><br><span class=\"line\">        <span class=\"attr\">use</span>: [</span><br><span class=\"line\">          &#123;</span><br><span class=\"line\">            <span class=\"attr\">loader</span>: <span class=\"title class_\">MiniCssExtractPlugin</span>.<span class=\"property\">loader</span>,</span><br><span class=\"line\">          &#125;,</span><br><span class=\"line\">          &#123;</span><br><span class=\"line\">            <span class=\"attr\">loader</span>: <span class=\"string\">&quot;css-loader&quot;</span>,</span><br><span class=\"line\">          &#125;,</span><br><span class=\"line\">        ],</span><br><span class=\"line\">      &#125;,</span><br><span class=\"line\">      ],</span><br><span class=\"line\">    ],</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n<p>上面配置了两个 css-loader，但只会运行第一个，因为第二个被 OneOf 给忽略掉了</p>\n<h3 id=\"includeexclude\"><a class=\"markdownIt-Anchor\" href=\"#includeexclude\">#</a> include/exclude</h3>\n<p>include 指定一个文件夹，文件夹下的文件会全部打包，不会忽略<br>\n exclude 指定一个文件夹，文件夹下的文件不会打包，会忽略</p>\n<h3 id=\"cache缓存\"><a class=\"markdownIt-Anchor\" href=\"#cache缓存\">#</a> cache (缓存)</h3>\n<p>每次打包都要经过 eslint 检查和 babel 编译，如果每次都重新编译，会非常消耗性能，所以需要缓存。<br>\n当然，主要是 js 需要缓存</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"attr\">test</span>: <span class=\"regexp\">/\\.js$/</span>,</span><br><span class=\"line\">  <span class=\"attr\">exclude</span>: <span class=\"regexp\">/node_modules/</span>, <span class=\"comment\">// 排除node_modules的js文件不处理</span></span><br><span class=\"line\">  <span class=\"attr\">loader</span>: <span class=\"string\">&quot;babel-loader&quot;</span>, <span class=\"comment\">// 使用babel-loader</span></span><br><span class=\"line\">  <span class=\"attr\">options</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">cacheDirectory</span>: <span class=\"literal\">true</span>, <span class=\"comment\">// 开启缓存</span></span><br><span class=\"line\">    <span class=\"attr\">cacheCompression</span>: <span class=\"literal\">false</span>, <span class=\"comment\">// 关闭缓存文件压缩</span></span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">&#125;,</span><br></pre></td></tr></table></figure>\n<h3 id=\"thead\"><a class=\"markdownIt-Anchor\" href=\"#thead\">#</a> Thead</h3>\n<p>多线程打包，可以加快打包速度<br>\n我们启动进程的数量就是我们 CPU 的核数<br>\n获取 CPU 核数</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> os = <span class=\"built_in\">require</span>(<span class=\"string\">&quot;os&quot;</span>);</span><br><span class=\"line\"><span class=\"keyword\">const</span> cpus = os.<span class=\"title function_\">cpus</span>().<span class=\"property\">length</span>;</span><br></pre></td></tr></table></figure>\n<p><strong>安装</strong></p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm install thread-loader --save-dev</span><br></pre></td></tr></table></figure>\n<p><strong>配置</strong></p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// config/webpack.config.prod.js</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> os = <span class=\"built_in\">require</span>(<span class=\"string\">&quot;os&quot;</span>)</span><br><span class=\"line\"><span class=\"keyword\">const</span> threads = os.<span class=\"title function_\">cpus</span>().<span class=\"property\">length</span></span><br><span class=\"line\"><span class=\"comment\">// webpack内置压缩plugin</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"title class_\">TerserWebpackPlugin</span> = <span class=\"title function_\">require</span>(<span class=\"params\"><span class=\"string\">&quot;terser-webpack-plugin&quot;</span></span>)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"attr\">test</span>: <span class=\"regexp\">/\\.js$/</span>,</span><br><span class=\"line\">  <span class=\"attr\">exclude</span>: <span class=\"regexp\">/node_modules/</span>, <span class=\"comment\">// 排除node_modules的js文件不处理</span></span><br><span class=\"line\">  <span class=\"attr\">use</span>: [</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">      <span class=\"attr\">loader</span>: <span class=\"string\">&quot;thread-loader&quot;</span>,</span><br><span class=\"line\">      <span class=\"attr\">options</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">works</span>: threads, <span class=\"comment\">// 开启几个线程</span></span><br><span class=\"line\">      &#125;,</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">      <span class=\"attr\">loader</span>: <span class=\"string\">&quot;babel-loader&quot;</span>,</span><br><span class=\"line\">      <span class=\"attr\">options</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">cacheDirectory</span>: <span class=\"literal\">true</span>, <span class=\"comment\">// 开启缓存</span></span><br><span class=\"line\">        <span class=\"attr\">cacheCompression</span>: <span class=\"literal\">false</span>, <span class=\"comment\">// 关闭缓存文件压缩</span></span><br><span class=\"line\">      &#125;,</span><br><span class=\"line\">    &#125;,,</span><br><span class=\"line\">  ], <span class=\"comment\">// 使用babel-loader</span></span><br><span class=\"line\">            <span class=\"attr\">options</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">cacheDirectory</span>: <span class=\"literal\">true</span>, <span class=\"comment\">// 开启缓存</span></span><br><span class=\"line\">    <span class=\"attr\">cacheCompression</span>: <span class=\"literal\">false</span>, <span class=\"comment\">// 关闭缓存文件压缩</span></span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">&#125;,</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// plugin的配置</span></span><br><span class=\"line\">    <span class=\"keyword\">new</span> <span class=\"title class_\">ESLintPlugin</span>(&#123;</span><br><span class=\"line\">      <span class=\"comment\">// 指定检测的文件</span></span><br><span class=\"line\">      <span class=\"attr\">context</span>: path.<span class=\"title function_\">resolve</span>(__dirname, <span class=\"string\">&quot;../src&quot;</span>),</span><br><span class=\"line\">      threads,</span><br><span class=\"line\">    &#125;),</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">new</span> <span class=\"title class_\">TerserWebpackPlugin</span>(&#123;</span><br><span class=\"line\">      <span class=\"attr\">parallel</span>: threads,</span><br><span class=\"line\">    &#125;),</span><br></pre></td></tr></table></figure>\n<h2 id=\"减少代码体积\"><a class=\"markdownIt-Anchor\" href=\"#减少代码体积\">#</a> 减少代码体积</h2>\n<h3 id=\"treesaking\"><a class=\"markdownIt-Anchor\" href=\"#treesaking\">#</a> TreeSaking</h3>\n<p>TreeSaking 是一个 webpack 插件，它能够分析出你的代码中那些部分是永远不会被用到，然后剔除掉这部分。<br>\nwebpack 默认开启</p>\n<h3 id=\"处理babel\"><a class=\"markdownIt-Anchor\" href=\"#处理babel\">#</a> 处理 Babel</h3>\n<p>Babel 为编译的每个文件都插入了辅助代码，使代码体积过大<br>\n我们可以将它们作为一个独立模块来避免重复引入<br>\n<strong>安装</strong></p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm install @babel/plugin-transform-runtime --save-dev</span><br></pre></td></tr></table></figure>\n<p><strong>配置</strong></p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// config/webpack.config.prod.js</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"attr\">loader</span>: <span class=\"string\">&quot;babel-loader&quot;</span>,</span><br><span class=\"line\">  <span class=\"attr\">options</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">cacheDirectory</span>: <span class=\"literal\">true</span>, <span class=\"comment\">// 开启缓存</span></span><br><span class=\"line\">    <span class=\"attr\">cacheCompression</span>: <span class=\"literal\">false</span>, <span class=\"comment\">// 关闭缓存文件压缩</span></span><br><span class=\"line\">    <span class=\"attr\">plugins</span>: [<span class=\"string\">&quot;@babel/plugin-transform-runtime&quot;</span>], <span class=\"comment\">// 开启babel-plugin-transform-runtime</span></span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">&#125;,</span><br></pre></td></tr></table></figure>\n<h3 id=\"code-split代码分割\"><a class=\"markdownIt-Anchor\" href=\"#code-split代码分割\">#</a> Code Split (代码分割)</h3>\n<p>打包会将所有 js 文件打包到一个文件，导致加载时间过长，我们可以将代码拆分成多个文件，然后按需加载。</p>\n<h4 id=\"多入口\"><a class=\"markdownIt-Anchor\" href=\"#多入口\">#</a> 多入口</h4>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// webpack.config.js</span></span><br><span class=\"line\"><span class=\"attr\">entry</span>: [</span><br><span class=\"line\">  <span class=\"attr\">app</span>: <span class=\"string\">&#x27;./src/app.js&#x27;</span>,</span><br><span class=\"line\">  <span class=\"attr\">main</span>: <span class=\"string\">&#x27;./src/main.js&#x27;</span>,</span><br><span class=\"line\">],</span><br><span class=\"line\"><span class=\"attr\">output</span>: &#123;</span><br><span class=\"line\">  <span class=\"attr\">path</span>: path.<span class=\"title function_\">resolve</span>(__dirname, <span class=\"string\">&#x27;dist&#x27;</span>),</span><br><span class=\"line\">  <span class=\"attr\">filename</span>: <span class=\"string\">&#x27;[name].js&#x27;</span>,<span class=\"comment\">// 以[name]自己的文件名作为文件名</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h4 id=\"多入口公共模块\"><a class=\"markdownIt-Anchor\" href=\"#多入口公共模块\">#</a> 多入口公共模块</h4>\n<p>多入口文件的公共的代码提升为公共模块单独打包</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// webpack.config.js</span></span><br><span class=\"line\"><span class=\"attr\">entry</span>: [</span><br><span class=\"line\">  <span class=\"attr\">app</span>: <span class=\"string\">&#x27;./src/app.js&#x27;</span>,</span><br><span class=\"line\">  <span class=\"attr\">main</span>: <span class=\"string\">&#x27;./src/main.js&#x27;</span>,</span><br><span class=\"line\">],</span><br><span class=\"line\"><span class=\"attr\">output</span>: &#123;</span><br><span class=\"line\">  <span class=\"attr\">path</span>: path.<span class=\"title function_\">resolve</span>(__dirname, <span class=\"string\">&#x27;dist&#x27;</span>),</span><br><span class=\"line\">  <span class=\"attr\">filename</span>: <span class=\"string\">&#x27;[name].js&#x27;</span>,<span class=\"comment\">// 以[name]自己的文件名作为文件名</span></span><br><span class=\"line\">&#125;,</span><br><span class=\"line\"><span class=\"attr\">optimization</span>: &#123;</span><br><span class=\"line\">  <span class=\"comment\">// 代码分割配置</span></span><br><span class=\"line\">  <span class=\"attr\">splitChunks</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">chunks</span>: <span class=\"string\">&#x27;all&#x27;</span>, <span class=\"comment\">// 所有模块都进行分割</span></span><br><span class=\"line\">    <span class=\"comment\">// minSize: 30000, // 模块大于30kb才进行分割</span></span><br><span class=\"line\">    <span class=\"comment\">// maxSize: 0, // 最大尺寸0</span></span><br><span class=\"line\">    <span class=\"comment\">// minChunks: 1, // 最少使用过一次就进行分割</span></span><br><span class=\"line\">    <span class=\"comment\">// maxAsyncRequests: 5, // 异步加载chunk的并发请求数量最多为5个</span></span><br><span class=\"line\">    <span class=\"comment\">// maxInitialRequests: 3, // 入口文件最多只能初始加载3个chunk</span></span><br><span class=\"line\">    <span class=\"comment\">// automaticNameDelimiter: &#x27;~&#x27;, // 命名分隔符</span></span><br><span class=\"line\">    <span class=\"comment\">// enforeSizeThreshold: 50000, // 模块大于50kb强制打包</span></span><br><span class=\"line\">    <span class=\"comment\">// name: true, // 缓存组名</span></span><br><span class=\"line\">    <span class=\"attr\">cacheGroups</span>: &#123;</span><br><span class=\"line\">      <span class=\"comment\">// 缓存组</span></span><br><span class=\"line\">      <span class=\"attr\">default</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">minSize</span>: <span class=\"number\">0</span>, <span class=\"comment\">// 模块大于0kb才进行分割</span></span><br><span class=\"line\">        <span class=\"attr\">minChunks</span>: <span class=\"number\">2</span>, <span class=\"comment\">// 最小使用过一次就进行分割</span></span><br><span class=\"line\">        <span class=\"attr\">priority</span>: -<span class=\"number\">20</span>, <span class=\"comment\">// 优先级</span></span><br><span class=\"line\">        <span class=\"attr\">reuseExistingChunk</span>: <span class=\"literal\">true</span>, <span class=\"comment\">// 如果当前的chunk包含的模块已经被其他chunk包含了，那么将不会再次被引入</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">&#125;,</span><br></pre></td></tr></table></figure>\n<h4 id=\"按需加载动态导入\"><a class=\"markdownIt-Anchor\" href=\"#按需加载动态导入\">#</a> 按需加载，动态导入</h4>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// import动态导入，会将动态导入的文件代码分割(分割成单独文件)，在需要使用的时候自动加载</span></span><br><span class=\"line\"><span class=\"variable language_\">document</span>.<span class=\"title function_\">getElementById</span>(<span class=\"string\">&quot;btn&quot;</span>).<span class=\"property\">onclick</span> = <span class=\"keyword\">function</span> (<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">import</span>(<span class=\"string\">&#x27;./count&#x27;</span>).<span class=\"title function_\">then</span>(<span class=\"function\"><span class=\"params\">res</span>=&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&quot;模块加载成功&quot;</span>,res.<span class=\"title function_\">default</span>(<span class=\"number\">2</span>,<span class=\"number\">1</span>))</span><br><span class=\"line\">  &#125;).<span class=\"title function_\">catch</span>(<span class=\"function\"><span class=\"params\">err</span>=&gt;</span>&#123;</span><br><span class=\"line\">    <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&quot;模块加载失败&quot;</span>,err)</span><br><span class=\"line\">  &#125;)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"单入口\"><a class=\"markdownIt-Anchor\" href=\"#单入口\">#</a> 单入口</h3>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// webpack.config.js</span></span><br><span class=\"line\"><span class=\"attr\">optimization</span>: &#123;</span><br><span class=\"line\">  <span class=\"comment\">// 代码分割配置</span></span><br><span class=\"line\">  <span class=\"attr\">splitChunks</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">chunks</span>: <span class=\"string\">&#x27;all&#x27;</span>, <span class=\"comment\">// 所有模块都进行分割</span></span><br><span class=\"line\">    <span class=\"comment\">// minSize: 30000, // 模块大于30kb才进行分割</span></span><br><span class=\"line\">    <span class=\"comment\">// maxSize: 0, // 最大尺寸0</span></span><br><span class=\"line\">    <span class=\"comment\">// minChunks: 1, // 最少使用过一次就进行分割</span></span><br><span class=\"line\">    <span class=\"comment\">// maxAsyncRequests: 5, // 异步加载chunk的并发请求数量最多为5个</span></span><br><span class=\"line\">    <span class=\"comment\">// maxInitialRequests: 3, // 入口文件最多只能初始加载3个chunk</span></span><br><span class=\"line\">    <span class=\"comment\">// automaticNameDelimiter: &#x27;~&#x27;, // 命名分隔符</span></span><br><span class=\"line\">    <span class=\"comment\">// enforeSizeThreshold: 50000, // 模块大于50kb强制打包</span></span><br><span class=\"line\">    <span class=\"comment\">// name: true, // 缓存组名</span></span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">&#125;,</span><br></pre></td></tr></table></figure>\n<h3 id=\"给动态导入的文件取名\"><a class=\"markdownIt-Anchor\" href=\"#给动态导入的文件取名\">#</a> 给动态导入的文件取名</h3>\n<p>动态导入时要取名<br>\n <code>import(/* weebpackChunkName: &quot;math&quot; */ &quot;./js/math&quot;)</code></p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// webpack.config.js</span></span><br><span class=\"line\"><span class=\"attr\">output</span>: &#123;</span><br><span class=\"line\">  <span class=\"attr\">chunkFilename</span>: <span class=\"string\">&#x27;static/js/[name].js&#x27;</span>, <span class=\"comment\">// 动态导入的文件名</span></span><br><span class=\"line\">  <span class=\"comment\">// 图片，字体等通过type:&quot;asset&quot;处理的资源</span></span><br><span class=\"line\">  <span class=\"attr\">assetModuleFilename</span>: <span class=\"string\">&quot;static/media/[name].[hash][ext]&quot;</span>,</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"preloadprefetch\"><a class=\"markdownIt-Anchor\" href=\"#preloadprefetch\">#</a> Preload/Prefetch</h3>\n<p>我们想要在浏览器空闲时间去加载后续需要使用的资源<br>\n而不是在需要时才加载，如果资源太大，用户还是会感到卡顿</p>\n<ul>\n<li>Preload: 告诉浏览器立即加载</li>\n<li>Prefetch: 告诉浏览器在空闲时加载</li>\n</ul>\n<p>它们都只会加载资源，不执行<br>\n Preload 只能加载当前页面需要使用的资源，Prefetch 可以加载下一个页面需要使用的资源<br>\n ** 注意：** 它们兼容性比较差<br>\n<strong>安装</strong></p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm i -D preload-webpack-plugin</span><br></pre></td></tr></table></figure>\n<p><strong>配置</strong></p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// webpack.config.js</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"title class_\">PreloadWebpackPlugin</span> = <span class=\"built_in\">require</span>(<span class=\"string\">&#x27;@vue/preload-webpack-plugin&#x27;</span>)</span><br><span class=\"line\"><span class=\"keyword\">new</span> <span class=\"title class_\">PreloadWebpackPlugin</span>(&#123;</span><br><span class=\"line\">  <span class=\"attr\">rel</span>: <span class=\"string\">&#x27;preload&#x27;</span>,</span><br><span class=\"line\">  <span class=\"attr\">as</span>: <span class=\"string\">&#x27;script&#x27;</span>,</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">  new PreloadWebpackPlugin(&#123;</span></span><br><span class=\"line\"><span class=\"comment\">  rel: &#x27;prefetch&#x27;,</span></span><br><span class=\"line\"><span class=\"comment\">&#125;)</span></span><br><span class=\"line\"><span class=\"comment\">*/</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"network-cache\"><a class=\"markdownIt-Anchor\" href=\"#network-cache\">#</a> Network Cache</h3>\n<p>如果 <code>main.js</code>  里面引入了 <code>sum.js</code>  并且打包时 <code>sum.js</code>  设置了 <code>hash</code>  值<br>\n如果 <code>sum.js</code>  发生变化，它的文件名的 <code>hash</code>  值就会发送变化<br>\n导致 <code>main.js</code>  也要重新打包。<br>\n所以我们希望有一个文件 a, 存储了 <code>sum.js</code>  的 <code>hash</code>  值， <code>main.js</code>  通过 a 去访问 <code>sum.js</code> , 这样无论 <code>sum.js</code>  的文件名的 <code>hash</code>  值怎么变都不会影响到 <code>main.js</code></p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// webpack.config.js</span></span><br><span class=\"line\"><span class=\"attr\">optimization</span>: &#123;</span><br><span class=\"line\">  <span class=\"attr\">runtimeChunk</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">name</span>: <span class=\"function\">(<span class=\"params\">entrypoint</span>) =&gt;</span> <span class=\"string\">`runtime~<span class=\"subst\">$&#123;entrypoint.name&#125;</span>.js`</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"core-js\"><a class=\"markdownIt-Anchor\" href=\"#core-js\">#</a> core-js</h3>\n<p>虽然有了 babel , 但它无法处理 async, promise 对象时，它还是无法处理<br>\n core-js 是专门用来处理 ES6 以上的 API 的  <code>polyfill</code> <br>\n<strong> 安装</strong></p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm i core-js</span><br></pre></td></tr></table></figure>\n<ul>\n<li>直接引入<br>\n然后在入口文件 <code>import 'core-js</code> <br>\n 但这样会使打包文件很大</li>\n<li>手动引入<br>\n <code>import 'core-js/es/promise</code></li>\n</ul>\n<p>如果我们想要按需加载，自动引入就需要取配置 babel</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// babel.config.js</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"attr\">presets</span>:&#123;</span><br><span class=\"line\">    [</span><br><span class=\"line\">      [</span><br><span class=\"line\">        <span class=\"string\">&quot;@babel/preset-env&quot;</span>,&#123;</span><br><span class=\"line\">        <span class=\"attr\">useBuiltIns</span>: <span class=\"string\">&quot;usage&quot;</span>,<span class=\"comment\">// 按需加载自动引入</span></span><br><span class=\"line\">        <span class=\"attr\">corejs</span>: <span class=\"number\">3</span>,</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">      ],</span><br><span class=\"line\">    ]</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"pwa渐进式网络应用程序\"><a class=\"markdownIt-Anchor\" href=\"#pwa渐进式网络应用程序\">#</a> PWA (渐进式网络应用程序)</h3>\n<p>我们希望给项目提供离线体验<br>\n<strong>安装</strong></p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm i -D workbox-webpack-plugin</span><br></pre></td></tr></table></figure>\n<p><strong>配置</strong></p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"title class_\">WorkboxPlugin</span> = <span class=\"built_in\">require</span>(<span class=\"string\">&quot;workbox-webpack-plugin&quot;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">new</span> <span class=\"title class_\">WorkboxPlugin</span>.<span class=\"title class_\">GenerateSW</span>(&#123;</span><br><span class=\"line\">  <span class=\"attr\">clientsClaim</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\">  <span class=\"attr\">skipWaiting</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n<p>最后还要在主文件注册生成 <code>server worker</code></p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// src/main.js</span></span><br><span class=\"line\"><span class=\"keyword\">if</span> (<span class=\"string\">&#x27;serviceWorker&#x27;</span> <span class=\"keyword\">in</span> navigator) &#123;</span><br><span class=\"line\">  <span class=\"variable language_\">window</span>.<span class=\"title function_\">addEventListener</span>(<span class=\"string\">&#x27;load&#x27;</span>, <span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">    navigator.<span class=\"property\">serviceWorker</span>.<span class=\"title function_\">register</span>(<span class=\"string\">&#x27;/service-worker.js&#x27;</span>)</span><br><span class=\"line\">      .<span class=\"title function_\">then</span>(<span class=\"function\">(<span class=\"params\">registration</span>) =&gt;</span> &#123;</span><br><span class=\"line\">        <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;SW registered: &#x27;</span>, registration)</span><br><span class=\"line\">      &#125;)</span><br><span class=\"line\">      .<span class=\"title function_\">catch</span>(<span class=\"function\">(<span class=\"params\">registrationError</span>) =&gt;</span> &#123;</span><br><span class=\"line\">        <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;SW registration failed: &#x27;</span>, registrationError)</span><br><span class=\"line\">      &#125;)</span><br><span class=\"line\">  &#125;)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n",
            "tags": []
        }
    ]
}